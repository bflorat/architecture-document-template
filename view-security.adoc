# Security view
:sectnumlevels: 4
:toclevels: 4
:sectnums: 4
:toc: left
:icons: font
:toc-title: Table of contents

*Last modified* : {docdate}

*Last global review* : _ _

*Document status* : _<'WIP', 'DRAFT', ...>_

//üè∑{"id": "a08e807e-1e9b-4752-a5b8-372a40665c49", "labels": ["context"]}
## Introduction
This is the security point of view. It describes all the measures implemented to prevent unauthorized use, misuse, illegitimate modification or misappropriation of application modules.
The other views of the document are accessible link:./README.adoc[from here].
The project glossary is available link:glossary.adoc[here]. We will not redefine the functional or technical terms used here.
[TIP]
Availability is dealt with in the infrastructure section. Even if availability concept is often handled with Integrity and Confidentiality (the "CIA triad"), this model is role-oriented and we feel that availability is more often managed by infrastructure architects than by the security experts.

//üè∑{"id": "cd8c64f1-d216-4b24-946c-175455e824a7", "labels": ["context","references"]}
### Reference Documentation
[TIP]
====
Mention here the reference (defined at IS level) architecture documents. This file should never summarize their content under penalty of quickly becoming obsolete and unmaintainable.
====

[PRE-FILLED]
====
.Documentary references
[cols="1e,1e,4e,4e"]
|====
| N ¬∞ | Version | Document title / URL | Detail

| 1 | 1.0 | Safety_measures.pdf | Catalog of qualified safety measures
| 2 | latest | Company security standards | http://acme.com/myurl
|====
====

//üè∑{"id": "ea245600-dbd6-4f56-a58c-8c77556643ad", "labels": ["context","uncertainty"]}
## Not ruled

//üè∑{"id": "a058d388-72e1-4136-8659-7a9db1c1a340", "labels": []}
### Points subject to further study
.Points subject to further study
[cols="1e,3e,1e,1e,2e"]
|====
| ID | Detail | Status | Subject holder | Deadline
| ES1
| It will be necessary to validate that the anti-CSRF measures put in place also resolve the flaws linked to the TLS + compression coupling (CRIME or BREACH type).
| WIP
| SOC team
| BEFORE 2040
|====

//üè∑{"id": "68a4f41c-1139-4cdd-bb9e-e15667f47fd9", "labels": []}
### Assumptions
.Assumptions
[cols="e,e"]
|====
| ID | Detail
| HS1
| The SAML solution currently in place in the organization does not meet the authentication requirements. An OpenID Connect solution will be implemented.
|====

//üè∑{"id": "53ae9c06-1846-4dd2-ab55-f4a784c6a676", "labels": ["detail_level::overview", "constraint"]}
## Constraints

[TIP]
====
List here the **security constraints** applicable to the architecture, including in particular:

- **Module isolation** within secured network zones (_DMZ, firewalls, reverse proxy, network segmentation, etc._).  
- **Applicable standards and policies** (_e.g., password policies, encryption requirements, MFA, compliance with security standards_).  
- **Legal and regulatory constraints** (_e.g., GDPR compliance, industry-specific requirements_).  
- **Access restrictions** between different zones and systems.  
====

====
Example 1: The password management policy must comply with standard `XYZ`, including minimum complexity and periodic renewal.  
====

====
Example 2: A module in the **Internet zone** is strictly prohibited from directly accessing the **Intranet zone**.  
====

====
Example 3: In application of the **GDPR**, user data must be encrypted **at rest and in transit** using **AES-256 and TLS 1.3**.  
====


//üè∑{"id": "4882e5b9-c250-4079-8b24-04996016606d", "labels": ["detail_level::overview", "requirement"]}
## Requirements

[TIP]
====
Present here the **requirements**, *not the measures or controls addressing them*.  
Those will be detailed in Chapter 3.  

For particularly sensitive projects, prepare a **risk analysis dossier**.  

Possible methodologies include:  

* The **NIST Risk Management Framework (RMF)** (NIST SP 800-37) or **ISO/IEC 27005** for information security risk management.  
* The https://cyber.gouv.fr/en/publications/ebios-risk-manager-method[EBIOS Risk Manager] (_Expression of Needs and Identification of Security Objectives_) method.  
====



//üè∑{"id": "323d4c77-810a-4015-bc1a-11da07e24f3b", "labels": []}
### Integrity Requirements

[TIP]
====
Integrity refers to the **accuracy, durability, and trustworthiness** of the application‚Äôs data.

Guaranteeing data integrity means ensuring that data **cannot be altered or deleted** either unintentionally (_e.g., disk crash, software corruption, application bug_) or intentionally (_e.g., man-in-the-middle attack, privilege escalation, insider sabotage_).

‚ö† **Do not multiply data classes unnecessarily**. A single classification for the entire application is often sufficient.
====

.Required integrity level by data class (example)
[cols='2e,1e,1e,1e,1e']
|====
|Data Class |Non-Integral [small]#(Integrity errors are tolerated)# |Detectable [small]#(Errors are quickly identified)# |Controlled [small]#(Errors are corrected)# |Integral [small]#(No alteration is tolerated)#

|**Business database data** | | | | X
|**Archived data** | | X | |
|**Aggregated statistical data** | | | X |
|**NoSQL Big Data silo (pre-consolidation)** | X | | |
|**Application source code** | | | | X
|**Generated official documents (e.g., tax notice PDF)** | | | | X
|====

[TIP]
====
Examples of associated mechanisms depending on the required integrity level:

- **Detectable** ‚Üí Access logs and digital fingerprint (hash) verification.  
- **Controlled** ‚Üí Version retention, auditability, automatic correction of detected errors.  
- **Integral** ‚Üí Encryption, digital signatures, synchronous replication, immutable storage (WORM).  
====


//üè∑{"id": "acfa846e-0ed7-4f41-a593-f4ee29e94efd", "labels": []}
### Confidentiality Requirements

[TIP]
====
Confidentiality is the guarantee that information **is accessible only to authorized individuals** (ISO 27018 definition).

**Best practices**:  

- Do not multiply data classes unnecessarily. A single classification may be sufficient for the entire application.  
- Ensure that confidentiality levels are **consistent with legal and contractual requirements**.  
====

.Required confidentiality level by data class
[cols="e,e,e,e,e"]
|====
|Data Class |Public [small]#(Accessible to anyone without restriction)# |Limited [small]#(Accessible only to authorized individuals)# |Restricted [small]#(Restricted to authorized internal staff)# |Private [small]#(Strictly individual access)#

|**Editorial content**  
| X | | | 

|**User profile data**  
| | X | | 

|**Account history**  
| | | X | 

|**Technical activity logs**  
| | | X | 

|**HR data (e.g., employee benefits)**  
| | | | X
|====

[TIP]
====
**Examples of applying confidentiality levels**:

- **Public** ‚Üí Web pages accessible without login.  
- **Limited** ‚Üí Information restricted to authenticated users (e.g., SaaS dashboard).  
- **Restricted** ‚Üí Sensitive internal data (e.g., system logs not accessible to customers).  
- **Private** ‚Üí Personal data visible only to the concerned user (e.g., payslip).  
====

[NOTE]
====
**Mapping to common US classification schemes**:  

- **Public** ‚Üí Public  
- **Limited** ‚Üí Internal Use Only  
- **Restricted** ‚Üí Confidential  
- **Private** ‚Üí Restricted / Highly Confidential (depending on corporate policy)  
====


//üè∑{"id": "94c138c1-3e8b-4eaf-8926-b5b9bfa6a86b", "labels": []}
### Identification Requirements

[TIP]
====
Identification makes it possible to **assign a unique identifier** to each user in order to distinguish them from others.  

**Note:** Identification **does not guarantee** that the user is who they claim to be. That is the role of authentication (e.g., password, MFA, etc.).  
====

.Identification requirements
[cols="1e,3e"]
|====
|Requirement |Description

|**Unique identifier**  
| Each user must have a **unique and non-shareable** identifier. A personal email address is a good example of such an identifier.  

|**Identity validation**  
| The existence of a user‚Äôs identity must be verified before any service call.  

|**Identifier permanence**  
| An identifier must **never be deleted, modified, or reused**, even after a user account has been removed.  
|====

[TIP]
====
**Best practices**:  

- **Favor stable and unique identifiers** (email, customer number, UUID, etc.).  
- **Avoid re-assignable identifiers** (e.g., incremental numeric IDs that may be reused after account deletion).  
- **Ensure identifier consistency** across all systems where it is used.  
====


//üè∑{"id": "9d0646cd-3e3f-4878-96de-f215c9f20bdc", "labels": []}
### Authentication Requirements

[TIP]
====
Authentication verifies that a user is indeed who they claim to be, by validating their identity through one or more factors of proof.

‚ö† **Do not confuse with identification**, which only distinguishes one user from another without validating their identity.

**Special cases**:  

- **Technical accounts** (e.g., batch jobs, applications, APIs) also require authentication (e.g., service accounts using certificates or SSH keys).  
- **Privileged accounts** (e.g., `root` on servers, application administrator accounts). These can be human or technical but can read/write/delete large volumes of data or perform irreversible operations (large blast radius).  
- **Initial authentication** (during registration) is often stricter than subsequent logins.  
- **Federated authentication** allows delegating authentication to an identity provider (SSO, OAuth2, SAML, etc.). See the next section.  
====

//üè∑{"id": "58bf95ee-2fc4-4972-ac2b-7e2f775a4eb9", "labels": ["detail_level::detailed"]}
#### Authentication Requirements by Use Case
The table below indicates the **authentication factors required** depending on the usage context:  

[cols="e,e,e,e,e,e,e"]
|====
|Authentication Case  
|Password compliant with the security policy  
|Known SSH public key  
|OTP via Token  
|Biometrics  
|Knowledge of business data  
|Verification link by email  

|Existing user login  
|X|||||  

|Account creation  
|||||XX|X  

|Password change  
|X|||||X  

|Access to secured logs  
||X||||  

|Adding a wire transfer beneficiary  
|X||X|||  

|Login to mobile application Y  
||||X|||  
|====

[TIP]
====
**Best practices**:  

- **Avoid password-only authentication** ‚Üí always prefer at least a second factor (OTP, biometrics, etc.).  
- **Use proven standards** ‚Üí FIDO2, WebAuthn, TOTP, SAML, OpenID Connect.  
- **Secure service accounts** ‚Üí avoid static passwords; prefer SSH keys, certificates, or JWT tokens.  
- **Manage revocation and renewal** ‚Üí implement mechanisms to regenerate a factor if lost or compromised.  
====



//üè∑{"id": "f552f1e6-9aea-4866-8da1-e7ed676fd228", "labels": ["level::advanced", "detail_level::detailed"]}
### Identity Federation Requirements

[TIP]
====
Identity federation allows a user to **reuse their credentials** managed by an **Identity Provider (IdP)** to authenticate across multiple independent systems.

Unlike **Single Sign-On (SSO)**, which ensures automatic login without re-entering credentials, federation **does not bypass authentication** but centralizes identity management.

**Common examples:**  

- **Login.gov (US)** ‚Üí Based on OpenID Connect, it enables US citizens to access federal services (IRS, Social Security, etc.) using a single account.  
- **"Sign in with [Google | Facebook | GitHub]"** ‚Üí Implemented via **OpenID Connect** or **OAuth2**, allowing the use of a third-party account for authentication on another platform.  

**Advantages of identity federation:**  

- **Simplifies account management** ‚Üí Fewer credentials for the user to remember.  
- **Reduces maintenance costs** ‚Üí Fewer password resets and less user management overhead.  
- **Improves security** ‚Üí Centralizes authentication with a trusted IdP, enabling strong authentication and MFA integration.  
====

====
**Example Application**

User identification and authentication will be externalized to **Auth0**, an identity provider (IdP) supporting **OIDC, SAML, and OAuth2**.  

**Objectives**:  

- **Centralize identity management** and avoid duplication of user accounts.  
- **Reduce costs** related to authentication development and operations.  
- **Enhance security** by delegating authentication to a standards-compliant IdP.  
====


//üè∑{"id": "400376ad-cc62-4ab3-8e96-5a9f9a954e49", "labels": ["level::advanced", "level::advanced"]}
### SSO and SLO Requirements

[TIP]
====
**Single Sign-On (SSO)** allows a user to authenticate once and gain access to multiple applications without re-entering credentials.  
**Single Log-Out (SLO)** ensures that logging out of one application automatically logs the user out of all other applications within the same trust domain.

**Key considerations:**

- **SSO can be complex** to implement, especially if an Identity Provider (IdP) infrastructure is not yet in place.  
- **Applications must be compatible** with the chosen protocol (SAML, OIDC, Kerberos, etc.).  
- **The business need must be justified** ‚Üí An application used infrequently may not require SSO.  
- **Security risk** ‚Üí A **weak authentication method** for one SSO-enabled application compromises the entire system (e.g., one weak password can expose all applications accessible via SSO).  

**Best practices:**

- Define **limited trust boundaries** (e.g., SSO only for internal applications).  
- Use **strong authentication (MFA)** to reduce impersonation risks.  
- Properly manage **sessions and token expirations**.  
- Consider **simpler centralized authentication (LDAP, CAS)** if full SSO is not justified.  
====

====
**Example 1: No need for SSO**  
The application portal relies on a JSR352 framework that already manages single authentication. No additional SSO required.  
====

====
**Example 2: No SSO or SLO required**  
The application runs autonomously and does not share authentication with other services.  
====

====
**Example 3: SSO required for an intranet environment**  

- Once authenticated on one intranet application, the user must **not be required to re-authenticate** on other applications until the session expires.  
- A **logout (SLO)** from one application must trigger **logout from all other applications** in the trust domain.  
- The chosen protocol will be **OIDC with the on-prem Keycloak Identity Provider**.  
====


//üè∑{"id": "01404b83-f96f-4649-ace0-e5611601b830", "labels": ["level::advanced"]}
### Non-repudiation requirements
[TIP]
====
Non-repudiation ensures that a user or an organization cannot deny having performed a specific action (signature, approval, transaction, etc.).
It generally relies on cryptographic mechanisms, particularly digital signatures and secure timestamping.

**Typical use cases:**  

- Signing of **contracts and legal commitments**.  
- Validation of **sensitive financial transactions**.  
- Submission of **official documents** (e.g., tax returns, notarized acts).  


**Regulatory references:**  

- **United States** ‚Üí The **ESIGN Act** (Electronic Signatures in Global and National Commerce Act) and **UETA** (Uniform Electronic Transactions Act) establish the legal validity of electronic signatures.  
- **European Union** ‚Üí The **eIDAS Regulation (EU 910/2014)** defines the framework for electronic identification and trust services, including **qualified electronic signatures** with strong non-repudiation guarantees.  
====

**Non-repudiation requirements by use case**
[cols="e,e,e,e"]
|===
|Signed action or document |Required signature level |Origin of client certificate |Origin of server certificate

|Income tax return (data X, Y, and Z)
|Legally binding digital signature (ESIGN / UETA)
|IRS PKI (or approved tax authority CA)
|Trusted Certification Authority (e.g., DigiCert, Verisign)

|Electronic employment contract
|Legally binding digital signature (ESIGN / UETA)
|Corporate PKI or HR identity management system
|External trusted CA

|Electronic payment validation
|Strong customer authentication with digital certificate (per PCI-DSS)
|Client‚Äôs banking certificate
|Payment provider PKI (e.g., Visa, Mastercard)
|===


//üè∑{"id": "958fcccc-60cb-4158-940f-279cd1d12c9b", "labels": []}
### Anonymity and privacy requirements
[TIP]
List the constraints of anonymity and legal privacy.
====
Example 1: No data consolidation should be possible between data in the PERSON domain and in the HEALTH domain.
====
====
Example 2: For the sake of confidentiality in the event of a computer intrusion, some personal data will be redacted before replication into the public area: cholesterol level and weight.
====
====
Example 3: No racial, political, union, religious or sexual orientation data can be stored in any form whatsoever in the IS.
====
====
Example 4: The OpenData data from the ‚Äúhousing‚Äù domain will only contain consolidated data at the common level, not more precise.
====
====
Example 5: In application of a European directive, a banner must inform the user of the presence of cookies.
====
====
Example 6: Pursuant to the GDPR, explicit consent from users to store their personal health data will be offered.
====

//üè∑{"id": "fcad5990-c241-4c88-b2c5-646602f8935a", "labels": ["level::intermediate"]}
### Authorization Requirements

[TIP]
====
An authorization (or permission) controls **access to a specific application function** (also called a **privilege** or **entitlement**) for a user or a group of users.

**Examples of application functions:**

- "Execute an interbank transfer"  
- "View account history"  
- "Delete a user"  

‚ö† It is recommended **not to create excessive numbers** of functions and roles in order to avoid combinatorial explosion and high management overhead.

Two main access control models are commonly used:

- **RBAC (Role-Based Access Control):**  
  Users are grouped into roles (e.g., `Administrator`, `Manager`, `User`) that determine their permissions. This is simple and widely used.

- **ABAC (Attribute-Based Access Control):**  
  Access decisions are based on user attributes, resource attributes, and context (e.g., *‚Äúallow access if role=Manager AND location=US AND time < 6PM‚Äù*).  

- **PBAC (Policy-Based Access Control):**  
  A broader term that often builds on ABAC, allowing complex authorization policies defined in policy engines (e.g., **OPA ‚Äì Open Policy Agent**).  

In mid-2020s, many organizations use a **hybrid model**, where **RBAC handles baseline roles** and **ABAC/PBAC adds fine-grained, contextual rules**.  

**Best practices for simplifying authorization management:**

- **Group** users into **groups** (e.g., `G_department_head`).  
- **Associate** a list of **functions/permissions** with a **role** (e.g., `R_Administrator`, `R_banker_level1`, `R_department_head`).  
- **Assign** roles to **users or groups** for better maintainability.  

**Classic role-based access control (RBAC) model:**  

image::diagrammes/roles.svg[Classic role-based access management]

**Predefined users and roles:**  
Be sure to specify generic user categories such as:

- **`@anonymous`**: unauthenticated users.  
- **`@authenticated`**: authenticated users.  

**Delegated authorization (OAuth2, etc.):**

If the application **delegates or consumes** authorizations via an **external system (OAuth2, OpenID Connect, etc.)**, it is necessary to specify:

- **Is the application an authorization provider or consumer?**  
- **Which types of authorizations are involved?**  
====

====
Example 1: **Unauthenticated users** will only have **read-only privileges**.  
====

====
Example 2: The application will use a **matrix-based authorization management system** based on **[roles] ‚Üí [groups or users]**.  
Details of authorizations will be documented in the **Detailed Functional Specifications (DFS)**.  
====

**Example role matrix:**  
[cols="e,e,e,e"]
|===
| _Group or user_ | _Role_ `delete` | _Role_ `administration` | _Role_ `basic data consultation`

| Group `g_users`
|
|
| X

| Group `@anonymous`
|
|
|

| Group `g_admin`
| X
| X
| X

| User `xyz`
| X
|
| X
|===


//üè∑{"id": "e72e5ea5-5711-4665-8a91-76c63cbca2bc", "labels": ["level::intermediate"]}
### Traceability and auditability requirements
[TIP]
====
List here the trace requirements for detecting, for example:
* Misuse of back-office applications by employees
* Computer intrusions
* Data alteration
The traces are nominative and complete to allow auditing. They are therefore themselves sensitive and often require a good level of confidentiality.
Differentiate:
* Application traces, i.e., assessments of a complete use case such as 'Agent X consulted Ms. Y's file' and that are stored in databases;
* ... and the application traces (logs) as in a log file: `[INFO] 2016/12/23 11:14[Agent X] Call of the consult service` which are of technical level and much more volatile.
====
For the most sensitive data, it is possible to provide traceability at two levels (tracing the consultation of traces) to avoid abusive hierarchical traceability.
The traceability of the data of the repositories (base of people typically) requires a complete historization, which is in any case a good practice. To do this, provide an MCD allowing a record to be added for each change with a modification date and an effective date.
====
Example 1: for module X, any business action (update or consultation) must be the subject of a application trace containing at least the agent, the date and in case of modification the previous and the new value.
====
====
Example 2: Any intrusion into the IS must be detected (as far as possible).
====
====
Example 3: We need to be able to reconstruct the history of any patient's record at any date.
====
.Data to be kept for proof
[cols="e,e,e"]
|===
| Data | Objective | Retention period
| Full log (IP, GMT time, detail) of orders placed on the site | Prove that the order has been placed | 1 year
| Date and content of the confirmation email | Prove that the confirmation email has been sent | 2 years
| Insurance contract signed and scanned in PDF | Prove that the contract has been signed | 5 years
| Initial tax notice with digital signature | Keep the amount and tax. | 5 years
|===

//üè∑{"id": "d1f16239-18f7-4a4a-875e-34a587eb88b4", "labels": ["solution"]}
## Security measures

//üè∑{"id": "e60500e8-b4a3-471c-941c-8fd8c02c4da9", "labels": [], "link_to": ["323d4c77-810a-4015-bc1a-11da07e24f3b"]}
### Integrity

.Measures to ensure the required level of integrity
[cols="e,e,e"]
|===
| Data class | Required level | Measures

| Business database data
| Integral
a|
* Use of **PostgreSQL RDBMS** with **SERIALIZABLE** transaction isolation level.  
* Entities referenced only by **technical IDs** generated from PostgreSQL sequences.  
* **WAL journaling** enabled to ensure crash recovery.  
* Periodic integrity check using `pg_checksums`.  

| Archived data
| Detectable
| Generation of **SHA-256 checksums** for backups and validation during restorations.  

| Computed data D1
| Controlled
| Store a **SHA-1 checksum** and automatically re-run the batch computation within **24h** if a discrepancy is detected.  

| NoSQL Big Data silo (pre-consolidation)
| Non-integral
| No specific measures, **no backups**; this data is temporary and recalculable.  

| Application source code
| Integral
a|
* Use of **Git SCM** with native integrity control (SHA-1/SHA-256 hashes).  
* Commit verification using **GPG signing**.  
* Strict merge strategy (**fast-forward only**).  

| Tax notice PDF
| Integral
a|
* **Digital signature** of net amount, date, and name via **PKCS#7 (RSA, SHA-256)**.  
* **Qualified timestamp** embedded in the signature (PAdES).  
* Inclusion of the hexadecimal signature in the **PDF footer** for later verification.  
|===


//üè∑{"id": "a64b5e5d-e4d4-4ed2-b425-19cd542fa58e", "labels": [], "link_to": ["acfa846e-0ed7-4f41-a593-f4ee29e94efd"]}
### Confidentiality

.Measures to ensure the required level of confidentiality
[cols="e,e,e"]
|===
| _Data class_ | _Required level_ | _Measures_

| Editorial content
| Public
| Secured exchanges via **HTTPS** (TLS 1.2+), **no authentication required**.

| Website account profile
| Limited
a|
* Access requires **successful authentication** with username/password.  
* **Secure password hashing** using **Argon2id**.  
* Use of **JWT** for session management with controlled expiration.  

| Account history
| Restricted
a|
* Access is **restricted to authorized operators**.  
* Consultation only via **secured PL/SQL queries** executed with a limited database role.  
* **Data masking** enabled for sensitive fields.  

| User activity logs
| Restricted
a|
* **Access restricted** to authorized operators via **SSH** with strong authentication (SSH key + MFA).  
* Automatic log rotation with **logrotate**.  
* Protection against **log injection / log forging**.  

| HR data ‚Äì employee social benefits
| Private
a|
* **AES-256 encryption** in the database stored as a **BLOB**.  
* **Client-side decryption only** via `forge.js` (JavaScript).  
* Additional password **never stored server-side**; loss of the password makes the data unrecoverable.  
* Data modified on the client is **encrypted before transmission** and stored in the BLOB through REST service X.  
|===

[TIP]
====
‚ö† **Confidentiality of derived data**:  

‚úî **Encrypted backups**:  
- Use of **Restic, Borg, Kopia** with **AES-GCM encryption** and secure storage.  
- **Enable S3 Object Lock (Compliance mode)** to prevent accidental or malicious deletion.  

‚úî **Client data encryption for thick clients**:  
- **Hardware encryption** with **SED (Self-Encrypting Drive)**.  
- **Partition-level software encryption** with **LUKS (dm-crypt)** or **BitLocker**.  
- **File-level encryption** with **encfs**, **Cryptomator**, or **dm-crypt**.  
====


//üè∑{"id": "3779a946-fc73-455b-8bab-3d5398ce0311", "labels": [], "link_to": ["94c138c1-3e8b-4eaf-8926-b5b9bfa6a86b"]}
### Identification

[TIP]
====
Describe here the method of identification for users and systems (batch jobs, APIs, external services).  
Specify the identification attributes and the mechanisms that guarantee the **uniqueness** and **persistence** of identifiers.  
====

====
Example 1: User identifiers will be the `uid` attribute of the DNs `cn=XXX,ou=service1,dc=company,dc=com` in the central LDAP directory.  
A filter will also be applied to restrict access to members of the group `ou=myapplication,dc=company,dc=com`.  
====

====
Example 2: To prevent the reuse of identifiers from deleted accounts, a history table `uid_history` will be added to the database and systematically checked before any new account creation.  
====

====
Example 3: Service accounts will be identified via a unique API key stored in a **secure Vault** and rotated automatically every 6 months.  
====

//üè∑{"id": "ac587042-7060-44cf-96aa-93fddadc15f5", "labels": [], "link_to": ["9d0646cd-3e3f-4878-96de-f215c9f20bdc"]}
### Authentication

[TIP]
====
Describe here the authentication mechanisms in place, including:  
- The method of password storage and verification.  
- Any additional authentication factors.  
- The lifecycle management of credentials (creation, update, deactivation).  
====

**Password-based authentication:**

====
Example 1: Registered users will authenticate via **username/password**, in compliance with password policy `P`.  
Passwords will be hashed and stored as **bcrypt digests with a cost factor of 12**.  
====

====
Example 2: Internal administrators will use **Kerberos-based SSO** with delegation through an OAuth2/OpenID Connect Identity Provider.  
====

====
Example 3: To enable account recovery, users will be able to reset their password via a **temporary email link** (valid for 10 minutes).  
====

**Strong authentication (2FA/MFA):**

====
Example 4: When adding a new wire transfer beneficiary in the online banking portal, the user must provide:  

  - Their regular password.  
  - An **OTP** generated by a TOTP application (Google Authenticator, FreeOTP, etc.).  
====

====
Example 5: Access to critical REST APIs will require **API key + signed JWT authentication**.  
API keys will be stored in a **Vault** and rotated automatically.  
====

**Securing sensitive authentications:**

====
Example 6: All failed authentication attempts will be **logged and monitored**.  
After **5 consecutive failures**, the account will be **temporarily locked for 30 minutes**.  
====

====
Example 7: Suspicious logins (new IP address, unusual location) will require **additional verification via OTP sent by email**.  
====

//üè∑{"id": "49de0015-9e27-4f60-91ca-282feec8345d", "labels": ["level::advanced","detail_level::detailed"], "link_to": ["f552f1e6-9aea-4866-8da1-e7ed676fd228"]}
### Identity Federation

[TIP]
====
The most common solutions currently are:

- **OpenID Connect (OIDC)**: a modern protocol built on OAuth 2.0, well-suited for web and mobile applications.  
- **SAML**: mainly used for enterprise SSO (e.g., ADFS, Shibboleth, Okta).  
- **OAuth 2.0**: only for **authorization**, not authentication (pseudo-authentication possible via an additional IdP).  

For web applications, specify **browser-related constraints** (cookie handling, SameSite policy, etc.).  
====

====
Example: The public-facing user interface will support identification and authentication via **Login.gov** (US federal identity service, based on OpenID Connect).  
Users will be able to log in using their existing accounts from trusted government agencies (e.g., IRS, Social Security).  
====


//üè∑{"id": "1c4774ab-e6fc-46a4-bb89-97e318a8dd8f", "labels": ["level::advanced", "level::advanced"],"link_to:":["400376ad-cc62-4ab3-8e96-5a9f9a954e49"]}
### SSO and SLO

[TIP]
====
Describe here the chosen technology and its integration within the architecture.  
Some common solutions:  

- **CAS** (Central Authentication Service)  
- **Keycloak**  
- **ForgeRock OpenAM**  
- **LemonLDAP::NG** (open source)  
- **Okta, Azure AD, Ping Identity** (widely used in enterprises)  

Be sure to specify web-specific constraints, including **cookie management**, **session tokens**, and the implications of **SameSite / CORS** policies.  
====

====
Example 1: The X user interface will integrate a **CAS Spring Security client** for SSO.  
The CAS server used will be **YYY**, with the **authentication realm** connected to **Active Directory (AD) Y**.  
====

====
Example 2: Like all applications in the **business portal**, the X user interface must implement **Single Logout (SLO)** by **handling logout callbacks** from the CAS server.  
====

====
Example 3: SSO will be implemented via **Keycloak** as the identity provider, with delegation to Active Directory via **LDAP**.  
====


//üè∑{"id": "8e35ee35-b5bc-433b-8389-f07e62a05339", "labels": ["detail_level::detailed"]}
### Service Accounts

[TIP]
====
**Service accounts** are used to authenticate an application or a batch job when accessing an infrastructure service (database, API, etc.).

**Best practices:**

- **Secure storage** of credentials (avoid storing secrets in plain text within configuration files).  
- **Automatic rotation** of secrets where possible (e.g., HashiCorp Vault, AWS Secrets Manager, Azure Key Vault).  
- **Minimal permissions** following the **Principle of Least Privilege**.  
====

.Service accounts
[cols='1,2,2']
|====
|Account | Resource requiring authentication | Credential storage method

|`jdbc_app` | PostgreSQL and SQL Server databases | **Stored as a Kubernetes Secret** (mounted as a volume only on the relevant pods)  
|`api_backend` | REST API X | **Authentication via signed JWT stored in a secure secrets vault**  
|`ci_cd_runner` | CI/CD server | **Stored in HashiCorp Vault with automatic secret rotation**  
|====


//üè∑{"id": "9f09dacf-d151-45af-a5f6-209823e7a401", "labels": ["level::advanced"],"link_to":["01404b83-f96f-4649-ace0-e5611601b830"]}
### Non-repudiation and Timestamping

====
Example: The tax declaration will be signed using the user‚Äôs client certificate (*X.509*, *RSA*, *SHA-256*) issued by organization X.  
====

[TIP]
====
**Cryptographic timestamping** is not a standalone requirement but is most often used **together with a digital signature** to ensure non-repudiation.  
Timestamping prevents any **alteration of dates** (*backdating or postdating*).  

It relies on **qualified timestamp tokens** (*RFC 3161, eIDAS in EU*) issued by a **trusted timestamping authority (TSA)**.  
In the US, this role may be provided by **trusted CAs** or services compliant with **NIST digital signature and timestamping standards**.  
====

====
Example: Digital signatures will be **timestamped** with a **qualified timestamp token**, issued by a **trusted timestamping authority (TSA) such as provider XYZ**.  
====


//üè∑{"id": "72efb92f-13f8-48e5-aed1-b57c4eab56fc", "labels": [],"link_to":["958fcccc-60cb-4158-940f-279cd1d12c9b"]}
### Anonymity and Privacy
====
Example 1: An **annual internal audit** will be conducted on:

- The **content of the databases**.  
- The **data extracts** shared with external partners.  
====

====
Example 2: Publicly exposed data will be **partially exported** using:  
`COPY (SELECT <allowed_columns> FROM table) TO <file>`  
**Sensitive columns will be excluded** from replication to the public zone.  
====

====
Example 3: A **cookie consent banner** will be implemented on all **Angular** application pages using the `angular-cookie-law` module.  
====


//üè∑{"id": "e6d0ad26-40b7-412e-b861-1f8e6e2299ca", "labels": ["level::intermediate"],"link_to":["fcad5990-c241-4c88-b2c5-646602f8935a"]}
### Authorization (Access Rights)

====
Example 1: **Authorization management** will be implemented **at the application level** and stored in the **PostgreSQL database**.  
The tables dedicated to access rights will be detailed in the **specification dossier**.  
====

====
Example 2: Access to **address books** will be controlled via **OAuth2**.  
The API used will be **Google OAuth2 in Java**.  
====


//üè∑{"id": "3819b8cc-d9c4-4d29-9ca1-adae300a79e2", "labels": ["level::intermediate"],"link_to":["e72e5ea5-5711-4665-8a91-76c63cbca2bc"]}
### Traceability and Auditability

====
Example 1: At the end of each **business action**, the **ReactJS** application will perform an **asynchronous call** to a dedicated REST service for **action traceability**.  
This service will store the **business traces** in an **Elasticsearch database** for consultation via **Kibana**.  
====

====
Example 2: A hybrid **Intrusion Detection System (IDS)** (*network + host*), based on **Wazuh**, will be **deployed on all machines** used by the application.  
====

====
Example 3: The **tables X, Y, ‚Ä¶** will be **versioned (historized)** according to the following model: +  
<class diagram describing data version retention>  
====

====
Example 4: All documents **serving as evidence** will be archived in the **Document Management System (DMS)** with metadata to allow indexing and fast retrieval.  
====

====
Example 5: Logs **containing the tag `[EVIDENCE]`** and originating from **all modules** will be:

- **Centralized** via the **Elasticsearch** log system.  
- **Transformed and enriched** with **Logstash**.  
- **Indexed daily** in the **Elastic `evidence` index** to facilitate searches and ensure compliance.  
====


//üè∑{"id": "5e00eeef-1d5b-4a21-ac19-116ae376d999", "labels": ["level::intermediate"]}
### Cyberthreat Mitigation

Cyberthreats include: malware, phishing, DoS/DDoS attacks, exploitation of vulnerabilities (known or zero-day), social engineering, online fraud, data leaks, ransomware, etc.

The response framework can be aligned with the **NIST Cybersecurity Framework (CSF 2.0)**, which defines six core functions:

1. **Govern**: Establish governance, roles, and responsibilities for cybersecurity.  
2. **Identify**: Understand and prioritize risks.  
3. **Protect**: Implement defense mechanisms.  
4. **Detect**: Identify ongoing attacks.  
5. **Respond**: Contain and neutralize threats.  
6. **Recover**: Restore services after an attack.  

//üè∑{"id": "d13f2885-ab5c-4543-9432-f53002c01c2c", "labels": []}
#### Prevention Solutions

These solutions help **anticipate threats** before they occur:

* **User and IT staff training and awareness**.  
* Make sure developers are familiar with and apply mitigations from the **https://owasp.org/www-project-top-ten/[OWASP Top 10]** application security best practices (e.g., protecting against injection, broken authentication, insecure design, and other critical risks).  

* **Intrusion Prevention Systems (IPS)** to block malicious actors.  
* **Regular access reviews** to minimize exposure.  
* **Security hardening**:  
  - Multi-factor authentication (MFA).  
  - Mandatory password rotation.  
  - Use of **secure vaults** for secret storage.  
* **Regular audits** (penetration tests, code audits) by internal or external experts.  
* **DLP (Data Loss Prevention) solutions** to monitor and prevent sensitive data leaks.  
* **Blocking attack vectors** (e.g., disabling USB ports).  
* **Automated security patching**.  

====
Example 1: User awareness training based on https://www.cisa.gov/resources-tools/resources/cisa-learning[guidance from CISA].  
====

====
Example 2: Deployment of the open-source IPS **CrowdSec**, leveraging community-driven intelligence (*crowdsourcing*).  
====

//üè∑{"id": "ac7dde83-27c9-4916-9020-73efaab5fcb1", "labels": []}
#### Detection Solutions

These solutions allow you to **identify attacks in progress**:

* **Next-generation antivirus (NGAV)** (AI- and heuristic-based, not only signatures).  
* **WAF (Web Application Firewall)** to analyze and block application-layer attacks.  
* **SIEM (Security Information and Event Management)** to correlate and analyze logs from multiple sources.  
* **IDS (Intrusion Detection Systems)** to monitor network traffic and detect attacks.  
* **SAST (Static Application Security Testing)** and **DAST (Dynamic Application Security Testing)**:  
  - SAST: Analysis of **source code** to identify known vulnerabilities.  
  - DAST: Analysis of **runtime behaviors**.  
* **SCA (Software Composition Analysis)**: Analyze software dependencies to detect **CVE (Common Vulnerabilities and Exposures)**.  

====
Example 1: Integration of **OWASP Dependency-Check** into the CI/CD pipeline to detect vulnerable libraries.  
====

//üè∑{"id": "d4498522-32aa-4987-aaec-2d9cf01130da", "labels": []}
#### Response Solutions

These solutions enable you to **react to and remediate** threats once detected:

* **Anti-malware solutions** to remove malicious software.  
* **Backup restoration plans** to resume operations quickly (**optimized MTTR**).  
* **Isolation of compromised zones** (network micro-segmentation, application sandboxing).  
* **Endpoint and software management** to **block unauthorized software**.  
* **Forensic analysis** to understand attack vectors and identify the source of compromise.  
* **Incident response procedures**, based on **NIST SP 800-61**.  

====
Example 1: Deployment of a **contingency plan** aligned with the recommendations of https://csrc.nist.gov/pubs/sp/800/61/r3/final[NIST SP 800-61 Incident Response Guide].  
====

//üè∑{"id": "a69b42f5-4f4e-42bf-b4bc-c6093941600f", "labels": ["level::advanced"]}
#### Prediction Solutions

These recent approaches rely on **behavioral analysis** and **machine learning**:

* **UEBA (User and Entity Behavior Analytics)**: Detect abnormal user or system behaviors.  
* **Complex attack simulations** (red teaming, purple teaming) to test resilience.  
* **Threat Intelligence**: Integration of real-time threat intelligence feeds.  

====
Example 1: Monitoring of suspicious behaviors via **AWS GuardDuty** on a cloud-hosted application.  
====

====
Example 2: Use of **CrowdSec Threat Intelligence** to anticipate attack trends.  
====


//üè∑{"id": "d4d0f075-dff9-4d81-aebc-bbd0cc45bb55", "labels": ["annexe"]}
## Annexes

//üè∑{"id": "b2f76b28-83da-478b-bc94-f1bc29dc6084", "labels": ["level::intermediate", "detail_level::detailed"]}
### RACI & Security Governance

[NOTE]
====
This RACI clearly defines the roles and responsibilities of the teams with regard to **information security management**.

:r: pass:quotes[[.green]#R#]
:a: pass:quotes[[.red]#A#]
:c: pass:quotes[[.blue]#C#]
:i: pass:quotes[[.orange]#I#]
:na: pass:quotes[[.grey]#N/A#]
:et: pass:quotes[[.grey]#&amp;#]

* {r}: *Responsible* (executes the action).  
* {a}: *Accountable* (approves the action and is answerable to the organization).  
* {c}: *Consulted* (provides expertise and must be consulted).  
* {i}: *Informed* (must be notified after completion).  

In a good RACI, there should **never** be more than one {a} per line.

Example:  

.AWS Cloud Services Management
[cols="6,^1,^1,^1"]
|===
||Systems & Cloud Team|Security Team|Network Team

.^|AWS account creation
.^|{r} {et} {a}
.^|{c} {et} {i}
.^|{i}

.^|IAM & AWS SCP policy creation
.^|{r}
.^|{a}
.^|{c}

.^|CloudTrail log management & CloudWatch alerts
.^|{r}
.^|{a}
.^|{i}
|===

.Application Accounts & IAM Management
[cols="6,^1,^1,^1"]
|===
||Directory Team|Project Team|SOC Team

.^|SSO account creation
.^|{r} {et} {a}
.^|{i}
.^|{i}

.^|Application entitlements management
.^|{i}
.^|{r} {et} {a}
.^|{c}

.^|Annual entitlements review
.^|{c} {et} {i}
.^|{i}
.^|{r} {et} {a}

|===
====


//üè∑{"id": "7d8dff71-3acd-450b-bc68-d2e2efee2fbb", "labels": ["level::intermediate","detail_level::detailed"]}
#### Vulnerability Self-Assessment

[TIP]
====
Vulnerability management follows the **OWASP Top 10**, **MITRE ATT&CK**, and **NIST 800-53** standards.

Objective: Verify that **protection, detection, and remediation measures** are correctly applied to reduce the risk of attacks (e.g., ransomware, supply chain attacks, injections‚Ä¶).  
====

.Vulnerability self-assessment checklist

Sample basic checks:

[cols="e,e,3e"]
|===
|Vulnerability
|Addressed?
|Technical measures implemented

|Exposure of unused ports
|‚úÖ
|Firewall configuration via **iptables/nftables**. Only ports 443 and 22 are open.

|SSH brute-force
|‚úÖ
|Use of **Fail2Ban** + SSH key-based authentication.

|Bypassing access controls
|‚úÖ
|Implementation of **Spring Security**, **OAuth2**, and **RBAC**.

|SQL / NoSQL injection
|‚úÖ
|Use of **Prepared Statements only** and secure ORMs.

|XSS (Cross-Site Scripting)
|‚úÖ
a|
* Systematic escaping of user input with **OWASP Java Encoder**.  
* **CSP (Content-Security-Policy)** enabled to limit execution of unauthorized scripts.  

|Secret and API key leaks
|‚úÖ
|Secrets stored in **Vault**.

|HTTPS attacks (CRIME, BREACH, DROWN)
|‚úÖ
a|
* **SSLv2 / SSLv3 disabled**.  
* **HSTS (HTTP Strict Transport Security)** enabled.  

|CSRF (Cross-Site Request Forgery)
|‚úÖ
|Use of the **double submit cookie pattern** and CSRF token validation.

|Security patch management
|‚úÖ
a|
* **Debian/Ubuntu** updates applied weekly via **unattended-upgrades**.  
* **PostgreSQL** updates applied within **7 days** after CVE publication.  
|===