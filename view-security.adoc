# Security view
:sectnumlevels: 4
:toclevels: 4
:sectnums: 4
:toc: left
:icons: font
:toc-title: Table of contents

*Last modified* : {docdate}

*Last global review* : _ _

*Document status* : _<'WIP', 'DRAFT', ...>_

//üè∑{"id": "a08e807e-1e9b-4752-a5b8-372a40665c49", "labels": ["context"]}
## Introduction
This is the security point of view. It describes all the measures implemented to prevent unauthorized use, misuse, illegitimate modification or misappropriation of application modules.
The other views of the document are accessible link:./README.adoc[from here].
The project glossary is available link:glossary.adoc[here]. We will not redefine the functional or technical terms used here.
[TIP]
Availability is dealt with in the infrastructure section. Even if availability concept is often handled with Integrity and Confidentiality (the "CIA triad"), this model is role-oriented and we feel that availability is more often managed by infrastructure architects than by the security experts.

//üè∑{"id": "cd8c64f1-d216-4b24-946c-175455e824a7", "labels": ["context","references"]}
### Reference Documentation
[TIP]
====
Mention here the reference (defined at IS level) architecture documents. This file should never summarize their content under penalty of quickly becoming obsolete and unmaintainable.
====
.Documentary references
[cols="1e,1e,3e,3e"]
|====
| N ¬∞ | Version | Document title / URL | Detail
| 1 | 1.0 | Safety_measures.pdf | Catalog of qualified safety measures
| 2 | latest | Company security standards | http://acme.com/myurl
|====

//üè∑{"id": "ea245600-dbd6-4f56-a58c-8c77556643ad", "labels": ["context","uncertainty"]}
## Not ruled

//üè∑{"id": "a058d388-72e1-4136-8659-7a9db1c1a340", "labels": []}
### Points subject to further study
.Points subject to further study
[cols="1e,3e,1e,1e,2e"]
|====
| ID | Detail | Status | Subject holder | Deadline
| ES1
| It will be necessary to validate that the anti-CSRF measures put in place also resolve the flaws linked to the TLS + compression coupling (CRIME or BREACH type).
| WIP
| SOC team
| BEFORE 2040
|====

//üè∑{"id": "68a4f41c-1139-4cdd-bb9e-e15667f47fd9", "labels": []}
### Assumptions
.Assumptions
[cols="e,e"]
|====
| ID | Detail
| HS1
| The SAML solution currently in place in the organization does not meet the authentication requirements. An OpenID Connect solution will be implemented.
|====

//üè∑{"id": "53ae9c06-1846-4dd2-ab55-f4a784c6a676", "labels": ["detail_level::overview", "constraint"]}
## Constraints

[TIP]
====
List here the **security constraints** applicable to the architecture, including in particular:

- **Module isolation** within secured network zones (_DMZ, firewalls, reverse proxy, network segmentation, etc._).  
- **Applicable standards and policies** (_e.g., password policies, encryption requirements, MFA, compliance with security standards_).  
- **Legal and regulatory constraints** (_e.g., GDPR compliance, industry-specific requirements_).  
- **Access restrictions** between different zones and systems.  
====

====
Example 1: The password management policy must comply with standard `XYZ`, including minimum complexity and periodic renewal.  
====

====
Example 2: A module in the **Internet zone** is strictly prohibited from directly accessing the **Intranet zone**.  
====

====
Example 3: In application of the **GDPR**, user data must be encrypted **at rest and in transit** using **AES-256 and TLS 1.3**.  
====


//üè∑{"id": "4882e5b9-c250-4079-8b24-04996016606d", "labels": ["detail_level::overview", "requirement"]}
## Requirements

[TIP]
====
Present here the **requirements**, *not the measures or controls addressing them*.  
Those will be detailed in Chapter 3.  

For particularly sensitive projects, prepare a **risk analysis dossier**.  

Possible methodologies include:  

* The **NIST Risk Management Framework (RMF)** (NIST SP 800-37) or **ISO/IEC 27005** for information security risk management.  
* The https://cyber.gouv.fr/en/publications/ebios-risk-manager-method[EBIOS Risk Manager] (_Expression of Needs and Identification of Security Objectives_) method.  
====



//üè∑{"id": "323d4c77-810a-4015-bc1a-11da07e24f3b", "labels": []}
### Integrity Requirements

[TIP]
====
Integrity refers to the **accuracy, durability, and trustworthiness** of the application‚Äôs data.

Guaranteeing data integrity means ensuring that data **cannot be altered or deleted** either unintentionally (_e.g., disk crash, software corruption, application bug_) or intentionally (_e.g., man-in-the-middle attack, privilege escalation, insider sabotage_).

‚ö† **Do not multiply data classes unnecessarily**. A single classification for the entire application is often sufficient.
====

.Required integrity level by data class (example)
[cols='2e,1e,1e,1e,1e']
|====
|Data Class |Non-Integral [small]#(Integrity errors are tolerated)# |Detectable [small]#(Errors are quickly identified)# |Controlled [small]#(Errors are corrected)# |Integral [small]#(No alteration is tolerated)#

|**Business database data** | | | | X
|**Archived data** | | X | |
|**Aggregated statistical data** | | | X |
|**NoSQL Big Data silo (pre-consolidation)** | X | | |
|**Application source code** | | | | X
|**Generated official documents (e.g., tax notice PDF)** | | | | X
|====

[TIP]
====
Examples of associated mechanisms depending on the required integrity level:

- **Detectable** ‚Üí Access logs and digital fingerprint (hash) verification.  
- **Controlled** ‚Üí Version retention, auditability, automatic correction of detected errors.  
- **Integral** ‚Üí Encryption, digital signatures, synchronous replication, immutable storage (WORM).  
====


//üè∑{"id": "acfa846e-0ed7-4f41-a593-f4ee29e94efd", "labels": []}
### Confidentiality Requirements

[TIP]
====
Confidentiality is the guarantee that information **is accessible only to authorized individuals** (ISO 27018 definition).

**Best practices**:  

- Do not multiply data classes unnecessarily. A single classification may be sufficient for the entire application.  
- Ensure that confidentiality levels are **consistent with legal and contractual requirements**.  
====

.Required confidentiality level by data class
[cols="e,e,e,e,e"]
|====
|Data Class |Public [small]#(Accessible to anyone without restriction)# |Limited [small]#(Accessible only to authorized individuals)# |Restricted [small]#(Restricted to authorized internal staff)# |Private [small]#(Strictly individual access)#

|**Editorial content**  
| X | | | 

|**User profile data**  
| | X | | 

|**Account history**  
| | | X | 

|**Technical activity logs**  
| | | X | 

|**HR data (e.g., employee benefits)**  
| | | | X
|====

[TIP]
====
**Examples of applying confidentiality levels**:

- **Public** ‚Üí Web pages accessible without login.  
- **Limited** ‚Üí Information restricted to authenticated users (e.g., SaaS dashboard).  
- **Restricted** ‚Üí Sensitive internal data (e.g., system logs not accessible to customers).  
- **Private** ‚Üí Personal data visible only to the concerned user (e.g., payslip).  
====

[NOTE]
====
**Mapping to common US classification schemes**:  

- **Public** ‚Üí Public  
- **Limited** ‚Üí Internal Use Only  
- **Restricted** ‚Üí Confidential  
- **Private** ‚Üí Restricted / Highly Confidential (depending on corporate policy)  
====


//üè∑{"id": "94c138c1-3e8b-4eaf-8926-b5b9bfa6a86b", "labels": []}
### Identification Requirements

[TIP]
====
Identification makes it possible to **assign a unique identifier** to each user in order to distinguish them from others.  

**Note:** Identification **does not guarantee** that the user is who they claim to be. That is the role of authentication (e.g., password, MFA, etc.).  
====

.Identification requirements
[cols="1e,3e"]
|====
|Requirement |Description

|**Unique identifier**  
| Each user must have a **unique and non-shareable** identifier. A personal email address is a good example of such an identifier.  

|**Identity validation**  
| The existence of a user‚Äôs identity must be verified before any service call.  

|**Identifier permanence**  
| An identifier must **never be deleted, modified, or reused**, even after a user account has been removed.  
|====

[TIP]
====
**Best practices**:  

- **Favor stable and unique identifiers** (email, customer number, UUID, etc.).  
- **Avoid re-assignable identifiers** (e.g., incremental numeric IDs that may be reused after account deletion).  
- **Ensure identifier consistency** across all systems where it is used.  
====


//üè∑{"id": "9d0646cd-3e3f-4878-96de-f215c9f20bdc", "labels": []}
### Authentication Requirements

[TIP]
====
Authentication verifies that a user is indeed who they claim to be, by validating their identity through one or more factors of proof.

‚ö† **Do not confuse with identification**, which only distinguishes one user from another without validating their identity.

**Special cases**:  

- **Technical accounts** (e.g., batch jobs, applications, APIs) also require authentication (e.g., service accounts using certificates or SSH keys).  
- **Privileged accounts** (e.g., `root` on servers, application administrator accounts). These can be human or technical but can read/write/delete large volumes of data or perform irreversible operations (large blast radius).  
- **Initial authentication** (during registration) is often stricter than subsequent logins.  
- **Federated authentication** allows delegating authentication to an identity provider (SSO, OAuth2, SAML, etc.). See the next section.  
====

//üè∑{"id": "58bf95ee-2fc4-4972-ac2b-7e2f775a4eb9", "labels": ["detail_level::detailed"]}
#### Authentication Requirements by Use Case
The table below indicates the **authentication factors required** depending on the usage context:  

[cols="e,e,e,e,e,e,e"]
|====
|Authentication Case  
|Password compliant with the security policy  
|Known SSH public key  
|OTP via Token  
|Biometrics  
|Knowledge of business data  
|Verification link by email  

|Existing user login  
|X|||||  

|Account creation  
|||||XX|X  

|Password change  
|X|||||X  

|Access to secured logs  
||X||||  

|Adding a wire transfer beneficiary  
|X||X|||  

|Login to mobile application Y  
||||X|||  
|====

[TIP]
====
**Best practices**:  

- **Avoid password-only authentication** ‚Üí always prefer at least a second factor (OTP, biometrics, etc.).  
- **Use proven standards** ‚Üí FIDO2, WebAuthn, TOTP, SAML, OpenID Connect.  
- **Secure service accounts** ‚Üí avoid static passwords; prefer SSH keys, certificates, or JWT tokens.  
- **Manage revocation and renewal** ‚Üí implement mechanisms to regenerate a factor if lost or compromised.  
====



//üè∑{"id": "f552f1e6-9aea-4866-8da1-e7ed676fd228", "labels": ["level::advanced", "detail_level::detailed"]}
### Identity Federation Requirements

[TIP]
====
Identity federation allows a user to **reuse their credentials** managed by an **Identity Provider (IdP)** to authenticate across multiple independent systems.

Unlike **Single Sign-On (SSO)**, which ensures automatic login without re-entering credentials, federation **does not bypass authentication** but centralizes identity management.

**Common examples:**  

- **Login.gov (US)** ‚Üí Based on OpenID Connect, it enables US citizens to access federal services (IRS, Social Security, etc.) using a single account.  
- **"Sign in with [Google | Facebook | GitHub]"** ‚Üí Implemented via **OpenID Connect** or **OAuth2**, allowing the use of a third-party account for authentication on another platform.  

**Advantages of identity federation:**  

- **Simplifies account management** ‚Üí Fewer credentials for the user to remember.  
- **Reduces maintenance costs** ‚Üí Fewer password resets and less user management overhead.  
- **Improves security** ‚Üí Centralizes authentication with a trusted IdP, enabling strong authentication and MFA integration.  
====

====
**Example Application**

User identification and authentication will be externalized to **Auth0**, an identity provider (IdP) supporting **OIDC, SAML, and OAuth2**.  

**Objectives**:  

- **Centralize identity management** and avoid duplication of user accounts.  
- **Reduce costs** related to authentication development and operations.  
- **Enhance security** by delegating authentication to a standards-compliant IdP.  
====


//üè∑{"id": "400376ad-cc62-4ab3-8e96-5a9f9a954e49", "labels": ["level::advanced", "level::advanced"]}
### SSO and SLO Requirements

[TIP]
====
**Single Sign-On (SSO)** allows a user to authenticate once and gain access to multiple applications without re-entering credentials.  
**Single Log-Out (SLO)** ensures that logging out of one application automatically logs the user out of all other applications within the same trust domain.

**Key considerations:**

- **SSO can be complex** to implement, especially if an Identity Provider (IdP) infrastructure is not yet in place.  
- **Applications must be compatible** with the chosen protocol (SAML, OIDC, Kerberos, etc.).  
- **The business need must be justified** ‚Üí An application used infrequently may not require SSO.  
- **Security risk** ‚Üí A **weak authentication method** for one SSO-enabled application compromises the entire system (e.g., one weak password can expose all applications accessible via SSO).  

**Best practices:**

- Define **limited trust boundaries** (e.g., SSO only for internal applications).  
- Use **strong authentication (MFA)** to reduce impersonation risks.  
- Properly manage **sessions and token expirations**.  
- Consider **simpler centralized authentication (LDAP, CAS)** if full SSO is not justified.  
====

====
**Example 1: No need for SSO**  
The application portal relies on a JSR352 framework that already manages single authentication. No additional SSO required.  
====

====
**Example 2: No SSO or SLO required**  
The application runs autonomously and does not share authentication with other services.  
====

====
**Example 3: SSO required for an intranet environment**  

- Once authenticated on one intranet application, the user must **not be required to re-authenticate** on other applications until the session expires.  
- A **logout (SLO)** from one application must trigger **logout from all other applications** in the trust domain.  
- The chosen protocol will be **OIDC with the on-prem Keycloak Identity Provider**.  
====


//üè∑{"id": "01404b83-f96f-4649-ace0-e5611601b830", "labels": ["level::advanced"]}
### Non-repudiation requirements
[TIP]
====
Non-repudiation ensures that a user or an organization cannot deny having performed a specific action (signature, approval, transaction, etc.).
It generally relies on cryptographic mechanisms, particularly digital signatures and secure timestamping.

**Typical use cases:**  

- Signing of **contracts and legal commitments**.  
- Validation of **sensitive financial transactions**.  
- Submission of **official documents** (e.g., tax returns, notarized acts).  


**Regulatory references:**  

- **United States** ‚Üí The **ESIGN Act** (Electronic Signatures in Global and National Commerce Act) and **UETA** (Uniform Electronic Transactions Act) establish the legal validity of electronic signatures.  
- **European Union** ‚Üí The **eIDAS Regulation (EU 910/2014)** defines the framework for electronic identification and trust services, including **qualified electronic signatures** with strong non-repudiation guarantees.  
====

**Non-repudiation requirements by use case**
[cols="e,e,e,e"]
|===
|Signed action or document |Required signature level |Origin of client certificate |Origin of server certificate

|Income tax return (data X, Y, and Z)
|Legally binding digital signature (ESIGN / UETA)
|IRS PKI (or approved tax authority CA)
|Trusted Certification Authority (e.g., DigiCert, Verisign)

|Electronic employment contract
|Legally binding digital signature (ESIGN / UETA)
|Corporate PKI or HR identity management system
|External trusted CA

|Electronic payment validation
|Strong customer authentication with digital certificate (per PCI-DSS)
|Client‚Äôs banking certificate
|Payment provider PKI (e.g., Visa, Mastercard)
|===


//üè∑{"id": "958fcccc-60cb-4158-940f-279cd1d12c9b", "labels": []}
### Anonymity and privacy requirements
[TIP]
List the constraints of anonymity and legal privacy.
====
Example 1: No data consolidation should be possible between data in the PERSON domain and in the HEALTH domain.
====
====
Example 2: For the sake of confidentiality in the event of a computer intrusion, some personal data will be redacted before replication into the public area: cholesterol level and weight.
====
====
Example 3: No racial, political, union, religious or sexual orientation data can be stored in any form whatsoever in the IS.
====
====
Example 4: The OpenData data from the ‚Äúhousing‚Äù domain will only contain consolidated data at the common level, not more precise.
====
====
Example 5: In application of a European directive, a banner must inform the user of the presence of cookies.
====
====
Example 6: Pursuant to the GDPR, explicit consent from users to store their personal health data will be offered.
====

//üè∑{"id": "fcad5990-c241-4c88-b2c5-646602f8935a", "labels": ["level::intermediate"]}
### Authorization Requirements

[TIP]
====
An authorization (or permission) controls **access to a specific application function** (also called a **privilege** or **entitlement**) for a user or a group of users.

**Examples of application functions:**

- "Execute an interbank transfer"  
- "View account history"  
- "Delete a user"  

‚ö† It is recommended **not to create excessive numbers** of functions and roles in order to avoid combinatorial explosion and high management overhead.

**Best practices for simplifying authorization management:**

- **Group** users into **groups** (e.g., `G_department_head`).  
- **Associate** a list of **functions/permissions** with a **role** (e.g., `R_Administrator`, `R_banker_level1`, `R_department_head`).  
- **Assign** roles to **users or groups** for better maintainability.  

**Classic role-based access control (RBAC) model:**  

image::diagrammes/roles.svg[Classic role-based access management]

**Predefined users and roles:**  
Be sure to specify generic user categories such as:

- **`@anonymous`**: unauthenticated users.  
- **`@authenticated`**: authenticated users.  

**Delegated authorization (OAuth2, etc.):**

If the application **delegates or consumes** authorizations via an **external system (OAuth2, OpenID Connect, etc.)**, it is necessary to specify:

- **Is the application an authorization provider or consumer?**  
- **Which types of authorizations are involved?**  
====

====
Example 1: **Unauthenticated users** will only have **read-only privileges**.  
====

====
Example 2: The application will use a **matrix-based authorization management system** based on **[roles] ‚Üí [groups or users]**.  
Details of authorizations will be documented in the **Detailed Functional Specifications (DFS)**.  
====

**Example role matrix:**  
[cols="e,e,e,e"]
|===
| _Group or user_ | _Role_ `delete` | _Role_ `administration` | _Role_ `basic data consultation`

| Group `g_users`
|
|
| X

| Group `@anonymous`
|
|
|

| Group `g_admin`
| X
| X
| X

| User `xyz`
| X
|
| X
|===


//üè∑{"id": "e72e5ea5-5711-4665-8a91-76c63cbca2bc", "labels": ["level::intermediate"]}
### Traceability and auditability requirements
[TIP]
====
List here the trace requirements for detecting, for example:
* Misuse of back-office applications by employees
* Computer intrusions
* Data alteration
The traces are nominative and complete to allow auditing. They are therefore themselves sensitive and often require a good level of confidentiality.
Differentiate:
* Application traces, i.e., assessments of a complete use case such as 'Agent X consulted Ms. Y's file' and that are stored in databases;
* ... and the application traces (logs) as in a log file: `[INFO] 2016/12/23 11:14[Agent X] Call of the consult service` which are of technical level and much more volatile.
====
For the most sensitive data, it is possible to provide traceability at two levels (tracing the consultation of traces) to avoid abusive hierarchical traceability.
The traceability of the data of the repositories (base of people typically) requires a complete historization, which is in any case a good practice. To do this, provide an MCD allowing a record to be added for each change with a modification date and an effective date.
====
Example 1: for module X, any business action (update or consultation) must be the subject of a application trace containing at least the agent, the date and in case of modification the previous and the new value.
====
====
Example 2: Any intrusion into the IS must be detected (as far as possible).
====
====
Example 3: We need to be able to reconstruct the history of any patient's record at any date.
====
.Data to be kept for proof
[cols="e,e,e"]
|===
| Data | Objective | Retention period
| Full log (IP, GMT time, detail) of orders placed on the site | Prove that the order has been placed | 1 year
| Date and content of the confirmation email | Prove that the confirmation email has been sent | 2 years
| Insurance contract signed and scanned in PDF | Prove that the contract has been signed | 5 years
| Initial tax notice with digital signature | Keep the amount and tax. | 5 years
|===

//üè∑{"id": "d1f16239-18f7-4a4a-875e-34a587eb88b4", "labels": ["solution"]}
## Security measures

//üè∑{"id": "e60500e8-b4a3-471c-941c-8fd8c02c4da9", "labels": [], "link_to": ["323d4c77-810a-4015-bc1a-11da07e24f3b"]}
### Integrity

.Measures to ensure the required level of integrity
[cols="e,e,e"]
|===
| Data class | Required level | Measures

| Business database data
| No alteration
a|
* Use of PostgreSQL RDBMS with a SERIALIZABLE transactional isolation level
* Entities will be referenced only by technical IDs from PostgreSQL sequences

| Archived data
| Detected
| Generation of SHA-256 checksums of backups

| Calculated data D1
| Controlled
| Storage of a SHA1 checksum, calculation automatical control within 24 hours.

| Big Data data lake before consolidation
| Alterable
| No special measure, no backup

| Sources
| No alteration
| Using the Git SCM

| Tax notice PDF
| No alteration
| Digital signature of the net amount + date + name in PKCS#7 (RSA, SHA256) format with timestamp. The resulting signature will be integrated a posteriori in hexadecimal format at the footer of the PDF.
|===


//üè∑{"id": "a64b5e5d-e4d4-4ed2-b425-19cd542fa58e", "labels": [], "link_to": ["acfa846e-0ed7-4f41-a593-f4ee29e94efd"]}
### Confidentiality

.Measures to ensure the requested level of confidentiality
[cols="e,e,e"]
|===
| Data class | Required level | Measures
| Editorial content | Public | Network flows in HTTPS, no authentication
| Website Account Profile | Limited | Access to this content requires successful authentication by login/password
| Account history | Reserved | Access to this content is reserved for authorized operators, only via PL/SQL queries from the database
| Logs of user activities | Reserved | Access to the log files is reserved for authorized operators (SSH access to machine M and Unix password)
| HR data social assistance to employees | Private | This data is encrypted in AES 256 in the form of a BLOB in the database, sent to the Web client via the REST Y service then decrypted in the browser in the Angular application (forge.js library) via an additional password of the user (not stored on the server side). + This is client-side only encryption. Loss of password makes data unrecoverable. Data changed on the client is encrypted and saved back to the BLOB through the REST X service.
|===
[TIP]
====
Also consider the confidentiality of derived data:
* encryption of backups;
* encryption of desktops. This can be hardware encryption in SED (Self Encryption Disk), software encryption at partition level (SafeGuard, dm-crypt) or file level (GnuPG, OpenSSL, TrueCrypt, etc.)
====

//üè∑{"id": "3779a946-fc73-455b-8bab-3d5398ce0311", "labels": [], "link_to": ["94c138c1-3e8b-4eaf-8926-b5b9bfa6a86b"]}
### Identification

_Example 1: The user ID of the application will be the uid attribute of the DNs `cn=XXX, ou=service1, dc=company, dc=com` in the central LDAP directory. A filter will also be applied on the membership of the group `ou=my application, dc=company, dc= com`._
_Example 2: To ensure that the IDs of deleted accounts are not reused, a history table will be added to the application and requested before any new account is created._

//üè∑{"id": "ac587042-7060-44cf-96aa-93fddadc15f5", "labels": [], "link_to": ["9d0646cd-3e3f-4878-96de-f215c9f20bdc"]}
### Authentication

[TIP]
====
For password authentication, describe how it is stored and verified. Also remember to describe the password updating solutions.
====
====
Example 1: The authentication of registered Internet users will be done by login/password (respecting the company password policy)
====
====
Example 2: The authentication of Internet users upon registration will be done by entering the Internet user code appearing on the invoices + the value of the last invoice and then by activating the account via a link appearing in a verification email.
====
====
Example 3: when creating a new beneficiary in the online bank app, the user will have to provide a unique password from their OTP token in addition to being authenticated.
====
====
Example 4: Passwords will in no case be kept plaintext but stored in the form of bcrypt digest.
====

//üè∑{"id": "49de0015-9e27-4f60-91ca-282feec8345d", "labels": ["level::advanced","detail_level::detailed"], "link_to": ["f552f1e6-9aea-4866-8da1-e7ed676fd228"]}
### Identity federation

[TIP]
====
The most common solutions are currently: OpenId Connect (OIDC), SAML or OAuth 2.0 (pseudo-authentication only for the latter). For Web applications, specify the browser constraints (activation of cookies in particular).
====
====
Example: The end-user website leverages Google https://developers.google.com/identity/protocols/oauth2/openid-connect[OIDC API] to handle authentication.
====

//üè∑{"id": "1c4774ab-e6fc-46a4-bb89-97e318a8dd8f", "labels": ["level::advanced", "level::advanced"],"link_to:":["400376ad-cc62-4ab3-8e96-5a9f9a954e49"]}
### SSO, SLO

[TIP]
====
Detail the chosen technology and its integration. Some common solutions: Keycloak, Shibboleth, CAS, OpenAM. For Web applications, specify the browser constraints (activation of cookies in particular).
====
====
Example 1: The GUI X will integrate a CAS spring-security client for SSO. The Shibboleth server used will be YYY. Its authentication realm will be the AD Y directory.
====
====
Example 2: Like every business portal application, GUI X will have to manage disconnection callbacks from the Shibboleth server following an SLO request.
====

//üè∑{"id": "8e35ee35-b5bc-433b-8389-f07e62a05339", "labels": ["detail_level::detailed"]}
### Service accounts
[TIP]
====
Service accounts should only be used for authentication to an infrastructure component (like a database) from a batch or an API.
====
.Service accounts
[cols = '1e,2e,2e']
|====
| Account | Resource requiring authentication | How credentials are stored?
| JDBC accounts (one account per database) | PG and SqlServer instances. | Clear storage in the configuration of data sources. Valued from a vault.
|====

//üè∑{"id": "9f09dacf-d151-45af-a5f6-209823e7a401", "labels": ["level::advanced"],"link_to":["01404b83-f96f-4649-ace0-e5611601b830"]}
### Non-repudiation and timestamping

====
Example: The tax return will be signed by the user's client certificate (X509, RSA, SHA-256 certificate) which was provided to him by the X module.
====
[TIP]
====
Cryptographic timestamping solutions do not meet a specific need but are often required to meet non-repudiation requirements (especially via timestamp tokens used in conjunction with an electronic signature to prevent backdating or postdating).
====
====
Example: Electronic signatures will be accompanied by a qualified eIDAS timestamp token issued by the trust service provider XYZ.
====

//üè∑{"id": "72efb92f-13f8-48e5-aed1-b57c4eab56fc", "labels": [],"link_to":["958fcccc-60cb-4158-940f-279cd1d12c9b"]}
### Anonymity and privacy

====
Example 1: an internal audit will be carried out once a year on the content of the database data and the extractions intended for partners.
====
====
Example 2: data destined for the public zone will be partially exported via a `COPY (SELECT‚Ä¶) TO `. Sensitive columns will thus be excluded from replication.
====
====
Example 3: the cookie acceptance banner will be implemented on all pages of the Angular application via the `angular-cookie-law` module.
====

//üè∑{"id": "e6d0ad26-40b7-412e-b861-1f8e6e2299ca", "labels": ["level::intermediate"],"link_to":["fcad5990-c241-4c88-b2c5-646602f8935a"]}
### Authorizations

====
Example 1: Authorization management will be managed by application and stored in the PostgreSQL application database. These tables will be described in the specification file.
====
====
Example 2: Obtaining the Facebook address book will be in OAuth2. We will use the Google OAuth2 Java API.
====

//üè∑{"id": "3819b8cc-d9c4-4d29-9ca1-adae300a79e2", "labels": ["level::intermediate"],"link_to":["e72e5ea5-5711-4665-8a91-76c63cbca2bc"]}
### Traceability, auditability

====
Example 1: At the end of each business action, the ReactJS application will invoke a business trace REST service asynchronously. This service will store the traces in an Elastic Search database for consultation in Kibana.
====
====
Example 2: the hybrid IDS tool (network + host) OSSEC will be installed on all the machines used by the application.
====
====
Example 3: The tables X, Y, .. will store data in a historical way according to the following principle:‚Ä¶ 
====
====
Example 4: all the documents used as proof will be archived.
====
====
Example 5: The logs containing the `[PROOF]` tag from any module will be centralized via the Elastic Search log centralization system and then inserted with Logstash processing on a daily basis to the Elastic `proof` index.
====

//üè∑{"id": "5e00eeef-1d5b-4a21-ac19-116ae376d999", "labels": ["level::intermediate"]}
### Combatting Cyber Threats
These technical or organizational measures help combat cyber threats such as malware, phishing, DOS/DDOS attacks, exploitation of vulnerabilities (known or zero-day), social engineering, online scams, sensitive data breaches, etc. Most solutions are implemented at the Information System (IS) level. Therefore, it is probably a matter of pointing to reference documents and detailing any solutions specific to your project or product.

//üè∑{"id": "d13f2885-ab5c-4543-9432-f53002c01c2c", "labels": []}
#### Prevention Solutions
Include:
* User training and awareness programs.
* Training and awareness programs for IT personnel.
* Implementation of an Intrusion Prevention System (IPS) that blocks malicious actors.
* Implementation and adherence to procedures, such as regular reviews of authorizations.
* Tightening of security rules such as enforcing mandatory multi-factor authentication, mandatory password renewal, or the use of digital safes (personal or shared) to store secrets.
* Regular audits (penetration tests and/or code audits) if possible by external experts.
* Data Loss Prevention (DLP) tools that analyze network flows or emails for leaks of sensitive data or intellectual property.
* Blocking certain attack vectors like USB drives.
* Automatic update systems for security patches on operating systems.
====
Example 1: User awareness through [these recommendations from the NSA](https://www.nsa.gov/What-We-Do/Cybersecurity/Best-Practices/).
====
====
Example 2: Risk awareness among IT professionals through https://www.nsa.gov/Press-Room/Cybersecurity-Advisories-Guidance/[NSA's cybersecurity guides].
====
====
Example 3: Implementation of the OpenSource IPS CrowdSec based on community information sharing (Crowdsourcing).
====

//üè∑{"id": "ac7dde83-27c9-4916-9020-73efaab5fcb1", "labels": []}
#### Detection Solutions
Include:
* Antivirus software (the latest generations include AI and go beyond signature searching).
* WAF (Web Application Firewall) that detects and blocks attack attempts in real-time.
* SIEM (Security Information and Event Management) tools that analyze logs from various sources.
* IDS (Intrusion Detection System) tools, often also performing IPS functions, analyzing network flows for malicious access attempts (such as exploitation of CVEs).
* SAST (Static Application Security Testing) and DAST (Dynamic Application Security Testing) tools analyzing the organization's source code and execution behavior, looking for known vulnerabilities.
* SCA (Software Composition Analysis) tools analyzing project dependencies (primarily Open Source) and reporting known CVEs (vulnerabilities) as soon as possible for updates.
====
Example 1: Implementation of the SCA tool OWASP Dependency-Check in CI/CD pipelines to detect Open Source libraries containing vulnerabilities (CVEs). Any presence of CVEs must be blocking.
====

//üè∑{"id": "d4498522-32aa-4987-aaec-2d9cf01130da", "labels": []}
#### Corrective Solutions
Include:
* Anti-malware solutions that remove malicious software.
* Backup restoration tools (knowledge of MTTR, defined in the infrastructure view, is crucial for restoration planning).
* Tools and procedures for isolating compromised modules or areas within the IS.
* Software asset management tools that block unauthorized software.
* Forensic analysis tools and methodologies for analyzing logs to understand attack paths and construct a post-mortem.
* Procedures and tools for responding to an attack.
====
Example 1: Preparation of procedures and a [contingency plan](https://www.cisa.gov/uscert/ncas/alerts/ta15-119a) in case of a security incident following the NIST SP 800-61 standard.
====

//üè∑{"id": "a69b42f5-4f4e-42bf-b4bc-c6093941600f", "labels": ["level::advanced"]}
#### Predictive Solutions
These recent solutions are primarily based on Machine Learning and the analysis of large-scale data (Big Data). They include:
* User and Entity Behavior Analytics (UEBA) solutions that detect abnormal behavior of certain users.
* Tools for simulating complex attacks.
* Tools and repositories for Threat Intelligence.
====
Example 1: Analysis and alerting of suspicious behaviors with AWS GuardDuty on an AWS-deployed cloud application.
====
====
Example 2: Using CrowdSec Threat Intelligence to discover threat trends based on real and consolidated data.
====


//üè∑{"id": "d4d0f075-dff9-4d81-aebc-bbd0cc45bb55", "labels": ["annexe"]}
## Annexes

//üè∑{"id": "b2f76b28-83da-478b-bc94-f1bc29dc6084", "labels": ["level::intermediate", "detail_level::detailed"]}
### RACI & Security Governance

[NOTE]
====
This RACI clearly defines the roles and responsibilities of the teams with regard to **information security management**.

:r: pass:quotes[[.green]#R#]
:a: pass:quotes[[.red]#A#]
:c: pass:quotes[[.blue]#C#]
:i: pass:quotes[[.orange]#I#]
:na: pass:quotes[[.grey]#N/A#]
:et: pass:quotes[[.grey]#&amp;#]

* {r}: *Responsible* (executes the action).  
* {a}: *Accountable* (approves the action and is answerable to the organization).  
* {c}: *Consulted* (provides expertise and must be consulted).  
* {i}: *Informed* (must be notified after completion).  

In a good RACI, there should **never** be more than one {a} per line.

Example:  

.AWS Cloud Services Management
[cols="6,^1,^1,^1"]
|===
||Systems & Cloud Team|Security Team|Network Team

.^|AWS account creation
.^|{r} {et} {a}
.^|{c} {et} {i}
.^|{i}

.^|IAM & AWS SCP policy creation
.^|{r}
.^|{a}
.^|{c}

.^|CloudTrail log management & CloudWatch alerts
.^|{r}
.^|{a}
.^|{i}
|===

.Application Accounts & IAM Management
[cols="6,^1,^1,^1"]
|===
||Directory Team|Project Team|SOC Team

.^|SSO account creation
.^|{r} {et} {a}
.^|{i}
.^|{i}

.^|Application entitlements management
.^|{i}
.^|{r} {et} {a}
.^|{c}

.^|Annual entitlements review
.^|{c} {et} {i}
.^|{i}
.^|{r} {et} {a}

|===
====


//üè∑{"id": "7d8dff71-3acd-450b-bc68-d2e2efee2fbb", "labels": ["level::intermediate","detail_level::detailed"]}
#### Self-check for vulnerabilities
[TIP]
====
Vulnerability management is well beyond the scope of this document, but it is good practice to monitor yourself to ensure that the most common vulnerabilities are addressed and how. This list is partly from the TOP 10 OWASP. Of course, there are many other control points depending on the context of the application.
====
.Self-checking checklist to take into account common vulnerabilities
[cols="e,e,3e"]
|===
| Vulnerability | Taken into account? | Technical measures undertaken
| Access to private ports | X | Configure the iptables firewall on the machine exposed to the Internet. Only ports 80 and 443 are open. The firewall will be configured in stateful mode (with conntrack extension)
| Brute force password attack | X | Use of fail2ban, imprisonment for 1 hour after 3 ssh connection attempts.
| Visibility of direct URLs | X | Centralization of all access from the Internet via an Apache reverse proxy + mod_proxy. Rewrite URLs to hide internal URLs.
| Bypassing access control | X | Use of SSO CAS
| SQL injection | X | Using PreparedStatement only, auditing SQL queries.
| NoSQL injection | X | Disabling JS support by MongoDB
| OS injection | X | Check that there is no system command call in the code (like `Runtime.exec()`)
| Authentication and session management violation | X | Treated with the anti-CSRF measures, see below.
| XSS | X | 
a|
* _Use of escapement library. For Java modules we will use StringEscapeUtils.escapeHtml4() from commons-lang_
* __Use of HTTP headers: X-Frame-Options SAMEORIGIN, X-Content-Type-Options nosniff, Content-Security-Policy__
* __ Systematic specification of encoding in the Content-Type response header (eg: text/html; charset=UTF-8) to counter attacks based on special characters bypassing anti-XSS__
| ReDOS | X | Checking that regular expressions used by anti-XSS measures are not eligible for this type of https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS[attack]
| Direct reference to an object | X | Checking with each request that the arguments passed correspond to the identified person. For example, any request contains its ID and a request verifies that the file she is trying to consult belongs to her well before continuing with the initial request.
| Planning for security updates | X | 
a|
* __Centos updates will be scheduled every first Wednesday of the month__
* __Wildfly updates are applied no more than two weeks after release__
| Sensitive data exposure | X | 
a|
* __All security algorithms are up to date: at least SHA-256, AES 256__
* __The SSL V2 and V3 is disabled on the Apache side following the DROWN flaw (SSLProtocol all -SSLv2 -SSLv3) __
* __The application only works in HTTPS__
* __The web server will set the HSTS header with includeSubDomains on all resources__
| CSRF | X | Using AngularJS Anti-CSRF (https://docs.angularjs.org/api/ng/service/$http)
| Lack of access control at the functional level | X | 
a|
* __ Implementation of the authorization policy__
* __Functional testing campaign__
| Log injection | X | 
a|
* __Escaping logs before sending them to log4j__
* __Verification of log consultation tools__
| HTTPS attacks + CRIME / BREACH compression | X | 
a|
* __Disabling HTTPS compression at Apache level: SSLCompression off __
* __Anti-CSRF measures__
| Upload malicious files | X | Validation of attachments by the anti-virus ClamAV
|===